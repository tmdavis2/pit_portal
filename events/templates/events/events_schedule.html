{% extends "pages/home.html" %}
{% block content %}

<style>
.schedule-page {
    width: 100%;
    max-width: none;
    margin: 0;
    padding: 40px 20px;
}

.schedule-header {
    text-align: center;
    margin-bottom: 50px;
}

.schedule-title {
    font-size: 3rem;
    font-weight: 700;
    color: #ffffff;
    margin-bottom: 20px;
}

.alert {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px 30px;
    border-radius: 12px;
    text-align: center;
    font-size: 1.1rem;
    font-weight: 500;
}

.alert-success {
    background: rgba(168, 85, 247, 0.2);
    border: 1px solid rgba(168, 85, 247, 0.5);
    color: #c084fc;
}

.no-events-message {
    text-align: center;
    color: #b0b0b0;
    font-size: 1.2rem;
    padding: 40px;
    margin: 40px auto;
}

.create-event-btn {
    background: linear-gradient(135deg, #a855f7 0%, #c084fc 100%);
    color: #ffffff;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    display: inline-block;
    margin-top: 20px;
    transition: all 0.3s ease;
}

.create-event-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
}

.calendar-grid-events {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 28px;
}

.event-card {
    background: #1a1a1a;
    border: 1px solid rgba(168, 85, 247, 0.3);
    border-radius: 20px;
    overflow: hidden;
    transition: all 0.4s ease;
}
.event-card:hover { transform: translateY(-6px); }


.card {
   background: rgba(26, 26, 26, 0.8);
   border: 1px solid rgba(168, 85, 247, 0.3);
   border-radius: 20px;
   padding: 40px;
}

.hero-card { max-width: 1000px; margin: 0 auto 40px; text-align: center; }

.hero-card h1 {
   font-size: 3rem;
   background: linear-gradient(135deg, #a855f7 0%, #c084fc 100%);
   -webkit-background-clip: text;
   -webkit-text-fill-color: transparent;
}

.calendar-controls {
   max-width: 1200px;
   margin: 40px auto;
   display: flex;
   justify-content: space-between;
   align-items: center;
   flex-wrap: wrap;
}

.calendar-grid {
    width: 100%;
    max-width: none;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 12px;
}

.day-header {
   text-align: center;
   padding: 15px;
   font-weight: 700;
   color: #a855f7;
}

.day-cell {
   background: #1a1a1a;
   border: 1px solid rgba(168, 85, 247, 0.2);
   border-radius: 12px;
   min-height: 120px;
}

.day-cell {
    aspect-ratio: 1;
}

.current-month {
    display: block;
    text-align: center;
    font-size: 2.5rem;
    font-weight: 700;
    background: linear-gradient(135deg, #a855f7 0%, #c084fc 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 20px;
}

.day-number {
    padding: 8px;
    font-weight: 600;
    color: #ffffff;
    font-size: 1.1rem;
}

.event-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin: 2px;
}

.event-dot.Tournament {
    background-color: #a855f7;
}

.event-dot.Schedule {
    background-color: #3b82f6;
}

.event-dot.Match {
    background-color: #10b981;
}

.event-dot.Practice {
    background-color: #f59e0b;
}

.other-month {
    opacity: 0.3;
}

.event-dot {
    display: inline-block;
    width: 12px;  /* Made bigger */
    height: 12px;  /* Made bigger */
    border-radius: 50%;
    margin: 4px;  /* More spacing */
}

</style>


<div class="schedule-page">
    <div class="schedule-header">
        <h1 class="schedule-title">üìÖ Events Schedule</h1>
        <p style="color: #b0b0b0; font-size: 1.1rem;">Upcoming tournaments and gaming events</p>
        <a href="{% url 'events:create_event' %}" class="create-event-btn">+ Create Event</a>
    </div>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <!-- Event Cards -->
    <div class="calendar-grid-events">
        {% for event in events %}
        <div class="event-card">
            <div class="event-content">
                <div class="event-date">üìÜ {{event.date}} at {{event.time}}</div>
                <h3 class="event-title">{{event.title}}</h3>
                <div class="event-details">
                    <div class="detail-item">üéÆ {{event.game}}</div>
                    {% if event.location %}
                    <div class="detail-item">üìç {{event.location}}</div>
                    {% endif %}
                </div>
                <span class="status-badge {{event.status}}">{{event.status}}</span>
            </div>
        </div>
        {% empty %}
        <p class="no-events-message">No events scheduled yet!</p>
        {% endfor %}
    </div>
</div>



<div class="schedule-page">
    <div class="card hero-card">
        <h1><i class="fa-solid fa-calendar"></i> Calendar View</h1>
        <p class="hero-subtitle">View upcoming events by month</p>
    </div>

    <div class="calendar-controls">
        <span class="current-month" id="currentMonth">December 2025</span>
    </div>

    <!-- Calendar Grid -->
    <div id="calendarView" class="calendar-grid">
        <div class="day-header">SUN</div>
        <div class="day-header">MON</div>
        <div class="day-header">TUE</div>
        <div class="day-header">WED</div>
        <div class="day-header">THU</div>
        <div class="day-header">FRI</div>
        <div class="day-header">SAT</div>
    </div>
</div>


{{ events_json|json_script:"events-data" }}

<script>
const eventsData = document.getElementById("events-data");
const events = eventsData ? JSON.parse(eventsData.textContent) : [];

document.addEventListener('DOMContentLoaded', function() {
   generateCalendar();
});

function generateCalendar() {
   const grid = document.getElementById('calendarView');
   const firstDayOfMonth = 1;
   const daysInMonth = 31;
  
   // Add empty cells before month starts
   for (let i = 0; i < firstDayOfMonth; i++) {
     const emptyCell = document.createElement('div');
     emptyCell.className = 'day-cell other-month';
     grid.appendChild(emptyCell);
   }

   // Add each day
   for (let day = 1; day <= daysInMonth; day++) {
     const dayCell = document.createElement('div');
     dayCell.className = 'day-cell';

     const number = document.createElement('div');
     number.className = 'day-number';
     number.textContent = day;
     dayCell.appendChild(number);

     // Find events for this day
     const todaysEvents = events.filter(e => e.date === day);
     
     if (todaysEvents.length > 0) {
        const dotsContainer = document.createElement('div');
        dotsContainer.style.cssText = 'text-align: center; margin-top: 8px; padding: 4px;';
        
        todaysEvents.forEach(event => {
            const eventItem = document.createElement('div');
            eventItem.style.cssText = 'display: flex; align-items: center; justify-content: center; margin: 4px 0;';
            
            const dot = document.createElement('span');
            dot.style.cssText = 'display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 6px; background-color: #a855f7; flex-shrink: 0;';
            
            const title = document.createElement('span');
            title.textContent = event.title;
            title.style.cssText = 'color: #ffffff; font-size: 0.75rem; text-align: left;';
            
            eventItem.appendChild(dot);
            eventItem.appendChild(title);
            dotsContainer.appendChild(eventItem);
        });
        dayCell.appendChild(dotsContainer);
     }

     grid.appendChild(dayCell);
   }
}
</script>

{% endblock %}
